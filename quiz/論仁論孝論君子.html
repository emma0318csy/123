<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>è©è§£å°æ¸¬é©—ï¼šè«–ä»è«–å­è«–å›å­</title>
  <style>
    body { font-family: sans-serif; padding: 2rem; max-width: 700px; margin: auto; }
    .question { font-weight: bold; margin-bottom: 1rem; }
    .options button { display: block; margin: 0.5rem 0; width: 100%; }
    .feedback { margin-top: 1rem; font-weight: bold; }
    .progress { margin-bottom: 1rem; font-size: 0.9rem; color: #555; }
    .review-item { border-bottom: 1px solid #ccc; padding: 0.5rem 0; }
  </style>
</head>
<body>
  <h1>è©è§£é¸æ“‡é¡Œï¼šè«–ä»è«–å­è«–å›å­</h1>
  <div class="progress" id="progress"></div>
  <div id="quiz">
    <div class="question" id="question"></div>
    <div class="options" id="options"></div>
    <div class="feedback" id="feedback"></div>
    <button onclick="nextQuestion()">ä¸‹ä¸€é¡Œ</button>
  </div>
  <div id="result" style="display:none;">
    <h2>ğŸ‰ æ¸¬é©—å®Œæˆ</h2>
    <p id="score"></p>
    <h3>å›é¡§ï¼š</h3>
    <div id="review"></div>
  </div>

  <script>
    let vocab = [];
    let quizSet = [];
    let current = 0;
    let correctCount = 0;
    let answers = [];

    fetch('../è©è§£/è«–ä»è«–å­è«–å›å­.json')
      .then(res => res.json())
      .then(data => {
        vocab = data;
        quizSet = shuffle(vocab).slice(0, 10);
        nextQuestion();
      });

    function shuffle(array) {
      return array.sort(() => Math.random() - 0.5);
    }

    function nextQuestion() {
      if (current >= quizSet.length) {
        showResult();
        return;
      }

      document.getElementById('feedback').textContent = '';
      document.getElementById('progress').textContent =
        `ç¬¬ ${current + 1} / ${quizSet.length} é¡Œã€€|ã€€âœ… æ­£ç¢ºï¼š${correctCount}ã€€âŒ éŒ¯èª¤ï¼š${current - correctCount}`;

      const q = quizSet[current];
      const wrong = shuffle(vocab.filter(x => x.åŸæ–‡ !== q.åŸæ–‡)).slice(0, 3).map(x => x.è©è§£);
      const options = shuffle([q.è©è§£, ...wrong]);

      document.getElementById('question').textContent = `ã€Œ${q.åŸæ–‡}ã€æ˜¯ä»€éº¼æ„æ€ï¼Ÿ`;
      const optDiv = document.getElementById('options');
      optDiv.innerHTML = '';

      options.forEach(opt => {
        const btn = document.createElement('button');
        btn.textContent = opt;
        btn.onclick = () => {
          const isCorrect = opt === q.è©è§£;
          document.getElementById('feedback').textContent =
            isCorrect ? 'âœ… æ­£ç¢ºï¼' : `âŒ éŒ¯äº†ï¼Œæ­£ç¢ºç­”æ¡ˆæ˜¯ï¼š${q.è©è§£}`;
          if (isCorrect) correctCount++;
          answers.push({ term: q.åŸæ–‡, chosen: opt, correct: q.è©è§£, result: isCorrect });
        };
        optDiv.appendChild(btn);
      });

      current++;
    }

    function showResult() {
      document.getElementById('quiz').style.display = 'none';
      document.getElementById('result').style.display = 'block';
      document.getElementById('score').textContent = `ä½ ç­”å°äº† ${correctCount} / ${quizSet.length} é¡Œ`;

      const reviewDiv = document.getElementById('review');
      answers.forEach(ans => {
        const div = document.createElement('div');
        div.className = 'review-item';
        div.innerHTML = `
          <strong>è©èªï¼š</strong>${ans.term}<br/>
          <strong>ä½ çš„ç­”æ¡ˆï¼š</strong>${ans.chosen}<br/>
          <strong>æ­£ç¢ºç­”æ¡ˆï¼š</strong>${ans.correct}<br/>
          <strong>çµæœï¼š</strong>${ans.result ? 'âœ… æ­£ç¢º' : 'âŒ éŒ¯èª¤'}
        `;
        reviewDiv.appendChild(div);
      });
    }
  </script>
</body>
</html>
